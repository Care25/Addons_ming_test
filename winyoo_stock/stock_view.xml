<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
 
 		<record id="winyoo_stock_stock_picking_form" model="ir.ui.view">
            <field name="name">winyoo.stock.stock_picking_form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
           
            <field name="arch" type="xml">
 

            	<button name="action_confirm" position="replace">
            	    <button name="action_confirm" states="draft" string="Mark as Todo" type="object" class="oe_highlight" groups="stock.group_stock_user"/>
            	</button>
<!-- BEWARE!!!!! -->
             	<xpath expr="//button[@string='Reverse Transfer']" position="attributes">
					<attribute name="groups">stock.reverse_transfer_group</attribute>
             	</xpath>

            	
            	<button name="action_assign" position="replace">
                    <button name="action_assign" states="confirmed" string="Check Availability" type="object" class="oe_highlight" groups="stock.group_stock_check_available"/>
                </button>
                
                <button name="rereserve_pick" position="replace">
                    <button name="rereserve_pick" states="partially_available" string="Recheck Availability" type="object" class="oe_highlight" groups="stock.group_stock_user"/>                    
                </button>
                <button name="force_assign" position="replace">    
                    <button name="force_assign" states="confirmed,waiting,partially_available" 
                    string="Force Availability" type="object" 
                    invisible="True"
                    groups="stock.group_stock_user"/>                
                </button>
                <button name="do_enter_transfer_details" position="replace">
                    <button name="do_enter_transfer_details" states="assigned,partially_available" 
                    	string="Transfer(WH)" 
                    	attrs="{'invisible': ['|',('picking_type_id','not in',[1,2,3,4,5])]}"
                    	groups="stock.group_stock_manager,base.group_erp_manager,stock.group_confirm_transfer_wh" 
                    	type="object" class="oe_highlight"/> 
                    <button name="do_enter_transfer_details" states="assigned,partially_available" 
                    	string="Transfer(Office)"
                    	attrs="{'invisible': ['|',('picking_type_id','in',[1,2,3,4,5])]}"
                    	groups="stock.group_stock_manager,base.group_erp_manager,stock.group_office_inventory_controller" 
                    	type="object" class="oe_highlight"/>                 
                </button>
                <button name="do_print_picking" position="replace">
                    <button name="do_print_picking" string="Print Picking List" groups="stock.group_stock_user" type="object" attrs="{'invisible': ['|', ('picking_type_code', '=', 'outgoing'), ('state', '!=', 'assigned')]}"/>                
                </button>
               
  				
                <button name="action_cancel" position="replace">
                    <button name="action_cancel" string="Cancel Transfer(ไม่ส่งหรือเลื่อนส่ง)" states="assigned,confirmed,partially_available,draft,waiting" groups="base.group_erp_manager,stock.cancel_transfer_group" type="object"/>                
                </button>
                <button name="do_unreserve" position="replace">
                  <!--<button name="do_unreserve" string="Unreserve" groups="base.group_user" type="object" attrs="{'invisible': [('quant_reserved_exist', '=', False)]}"/> -->   
                    <button name="do_unreserve" string="Unreserve(ยกเลิกเตรียมส่ง)" groups="stock.group_stock_user, base.group_sale_salesco" type="object" attrs="{'invisible': [('quant_reserved_exist', '=', False)]}"/>
            	</button>
            	            	
            
		    	<field name="backorder_id" position="after">
		    		<br/><br/><br/><br/><br/><br/>
		    		<h3 attrs="{'invisible': [('picking_type_code', '!=', 'incoming')]}"><font color='blue'>เอกสารสำคัญขาเข้า</font></h3><br/>
		    		<field name="ro_ref" attrs="{'invisible': [('picking_type_code','!=','incoming')]}"/>
		    		<field name="invoice_sup_ref" attrs="{'invisible': [('picking_type_code','!=','incoming')]}"/>
		    		
		    	</field>
		    			    	
		    	<field name="origin" position="after">
		    		<field name="state_confirm_receive" attrs="{'invisible': [('picking_type_code','!=','incoming')],'required': [('picking_type_code','=','incoming')]}"/><!-- รอเติมว่าและตัง้ default เป็น X ด้วย ถ้าstatusเป็น transfer น่าจะมาเปลี่ยนตรงนี้เป็นส่งแล้วด้วย (หรือจะละไว้ก่อนได้) -->
		    		<br/><br/>
		    		<h3 attrs="{'invisible': [('picking_type_code','!=','outgoing')]}"><font color='blue'>เอกสารสำคัญขาออก</font></h3><br/>
		    		<field name="dop_ref" attrs="{'invisible': [('picking_type_code','!=','outgoing')]}" />
		    		<field name="invoice_ref" attrs="{'invisible': [('picking_type_code','!=','outgoing')]}" />
		    		<field name="picker_name" attrs="{'invisible': [('picking_type_code','!=','outgoing')]}" />
		    		
		    		
		    	</field>

		    </field>
		</record>
 	
		
        <record id="winyoo_view_move_form" model="ir.ui.view">
            <field name="name">winyoo.stock.move.form</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_form"/>
            <field name="arch" type="xml">
                <button name="action_confirm" position="replace">
                    <button name="action_confirm" states="draft" 
                    string="Process Later" type="object" groups="stock.group_stock_user"
                    class="oe_highlight"/>
                </button>
                <button name="action_done" position="replace">
                    <button name="action_done" states="draft,assigned,confirmed" 
                    string="Process Entirely" type="object" groups="stock.group_stock_user"
                    class="oe_highlight"/>
                </button>
                <button name="force_assign" position="replace">
                    <button name="force_assign" states="confirmed" 
                    string="Set Available" type="object" groups="stock.group_stock_user" 
                    invisible="True" class="oe_highlight"/>
                </button>
                <button name="action_cancel" position="replace">
                    <button name="action_cancel" states="draft,assigned,confirmed" 
                    string="Cancel Move" groups="stock.group_stock_user"
                    type="object"/>
				</button>
            </field>
        </record>
		
		
 
 
         <!-- Stock incoterms -->
        <record id="winyoo_view_incoterms_tree" model="ir.ui.view">
            <field name="name">winyoo.stock.incoterms.tree</field>
            <field name="model">stock.incoterms</field>
            <field name="inherit_id" ref="stock.view_incoterms_tree"/>
            <field name="arch" type="xml">

                    <field name="name" position="after">
                    	<field name="explanation"/>
                    </field>

                    
            </field>
        </record>
        <record id="winyoo_stock_incoterms_form" model="ir.ui.view">
            <field name="name">winyoo.stock.incoterms.form</field>
            <field name="model">stock.incoterms</field>
            <field name="inherit_id" ref="stock.stock_incoterms_form"/>
            <field name="arch" type="xml">
                        <field name="code" position="after">
                        	<field name="explanation"/>
                        </field>

            </field>	
        </record>

        <record id="winyoo_view_move_picking_form" model="ir.ui.view">
            <field name="name">winyoo.stock.move.form</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_picking_form"/>
            <field name="arch" type="xml">
					<!--                 
                        <button name="action_confirm" states="draft" string="Confirm" type="object" groups="base.group_user"/>
 					-->
 						<button name="force_assign" position="replace">
 							<button name="force_assign" states="confirmed" string="Force Availability" type="object" groups="base.group_erp_manager"/>
                        </button>
                        <button name="do_unreserve" position="replace">
                        	<button name="do_unreserve" states="assigned" string="Cancel Availability" type="object" groups="base.group_erp_manager,base.group_sale_salesco"/>
						</button>          
 			</field>
 		</record>
 		
 		 <!-- Bam: แก้ให้หน้า stock picking เรียงตาม schedule date  ตอนนี้ใช้งานไม่ได้ไม่รู้ทำไม-->
 		 <record id="stock_vpicktree_winyoo" model="ir.ui.view">
			<field name="name">stock.vpicktree.winyoo</field>
			<field name="model">stock.picking</field>
			<field name="inherit_id" ref="stock.vpicktree"/>            
			<field name="arch" type="xml">
				<field name="date" position="replace">
					<field name="date" invisible="1"/>
				</field>
				<field name="min_date" position="replace">
					<field name="min_date" invisible="0"/>
					<field name="picking_type_code" invisible="1"/>
					<field name="state_confirm_receive"/>
					<field name="product_type"/>
				</field>
				<!-- <tree string="Picking list" position="attributes"> -->
				<tree position="attributes">
					<attributes name="default_order">min_date asc</attributes>
				</tree>
				
				                 
			</field>
		</record>

		<record id="view_move_tree_receipt_picking_kwan" model="ir.ui.view">
            <field name="name">stock.move.tree2_kwan</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_tree_receipt_picking"/>
            <field name="priority" eval="6"/>
            <field name="arch" type="xml">
            	
				<field name="date_expected" position="replace"></field>

             	<field name="date" position="after">
                    	<field name="date_expected" string="Expected Date"/>
                </field> 
                
                <tree string="Moves" position="attributes">
					<attribute name="default_order">date_expected</attribute>
				</tree>

            </field>
        </record>
             
         <record id="winyoo_view_inventory_form" model="ir.ui.view">
            <field name="name">winyoo.stock.inventory.form</field>
            <field name="model">stock.inventory</field>
		    <field name="inherit_id" ref="stock.view_inventory_form"/>            
            <field name="arch" type="xml">
<!-- แก้เพิ่มสิทธิให้ปุ่ม Start inventory ให้ -->
            		<button name="prepare_inventory" position="replace">			
                    	<button name="prepare_inventory" states="draft" string="Start Inventory" type="object" class="oe_highlight" 
                    		groups="stock.group_stock_user,stock.group_office_inventory_controller"/>
                    </button>	
<!--                     <button name="action_done" states="confirm" string="Validate Inventory" type="object" class="oe_highlight" groups="stock.group_stock_manager"/>
                    <button name="action_cancel_draft" states="cancel" string="Set to Draft" type="object"/>
                    <button name="action_cancel_inventory" states="confirm" string="Cancel Inventory" type="object"/>
 -->
            </field>
        </record>

<!-- เพิ่มเมนุ Wait to delivery -->


        <record id="wait_to_delivery" model="ir.ui.view">
            <field name="name">wait.to.delivery</field>
            <field name="model">stock.picking</field>            
            <field name="arch" type="xml">
				<tree string="Wait to Delivery" default_order="min_date" colors="green:state == 'assigned';red:(state in ('partially_available','confirmed','waiting'))">
                          <field name="min_date"/>
                          <field name="partner_id"/>
                          <field name="origin"/>
                          <field name="state"/>
                </tree>        
            </field>
        </record>           

        <record id="action_wait_to_delivery" model="ir.actions.act_window">
            <field name="name">Wait to Delivery</field>
            <field name="res_model">stock.picking</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="wait_to_delivery"/>
            <field name="domain">[('picking_type_code', '=','outgoing')]</field>
            <field name="context" eval="{'search_default_confirmed': 1,'search_default_available' : 1}"/>
            <!-- <field name="context" eval="{'search_default_confirmed': 1,'search_default_available' : 1,'search_default_picking_type_id': 2}"/>-->
        </record>
        
 		<menuitem id="base.menu_customer_order_work_control" 
				name="Customers Order Work Control" parent="base.menu_base_partner" 
				sequence="2"/>
		<menuitem action="action_wait_to_delivery" id="menu_wait_delivery" 
			name="Wait to Delivery" parent="base.menu_customer_order_work_control" 
			sequence="7"/>

<!-- Menu All Operation แยก warehouse กับ office -->
<!-- warehouse_id=1 คือ WH/stock -->
		<record id="action_picking_type_form_office_only" model="ir.actions.act_window">
            <field name="name">All Operations in office</field>
            <field name="res_model">stock.picking.type</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,form</field>
            <field name="domain">[('warehouse_id', '!=',1)]</field>
            <field name="context">{}</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new picking type. 
              </p><p>
                The picking type system allows you to assign each stock
                operation a specific type which will alter its views accordingly.  
                On the picking type you could e.g. specify if packing is needed by default, 
                if it should show the customer.  
              </p>
            </field>
        </record>
        
        <record id="action_picking_type_form_warehouse_only" model="ir.actions.act_window">
            <field name="name">All Operations Warehouse Only</field>
            <field name="res_model">stock.picking.type</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,form</field>
            <field name="domain">[('warehouse_id', '=',1)]</field>
            <field name="context">{}</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new picking type. 
              </p><p>
                The picking type system allows you to assign each stock
                operation a specific type which will alter its views accordingly.  
                On the picking type you could e.g. specify if packing is needed by default, 
                if it should show the customer.  
              </p>
            </field>
        </record>
            
		<menuitem
            action="action_picking_type_form_warehouse_only"
            id="menu_action_picking_type_form"
            name="All Operations in Warehouse"
            parent="stock.menu_stock_warehouse_mgmt" sequence="2"      
            groups="stock.group_stock_user,base.group_stock_observer"/>   
		<menuitem
            action="action_picking_type_form_office_only"
            id="menu_action_picking_type_form_office_only"
            parent="stock.menu_stock_warehouse_mgmt" sequence="3"
            groups="stock.group_stock_user,base.group_stock_observer,stock.group_office_inventory_controller"/>
            <!-- groups="stock.group_stock_user,base.group_sale_salesco,base.group_stock_observer" -->

<!-- แก้สิทธิ menu item -->
		<!-- Menu: Warehouse หัวข้อใหญ่อันบนสุด-->
        <menuitem name="Warehouse"
            id="stock.menu_stock_root"
            groups="stock.group_stock_manager,stock.group_stock_user,base.group_stock_observer,stock.group_office_inventory_controller"
            sequence="70"/>        
           <!-- groups="stock.group_stock_manager,stock.group_stock_user,base.group_sale_salesco,purchase.group_purchase_user,base.group_stock_observer" -->
		
		<!-- พวก traceablility กับ inventory control ถ้ามีสิทธิใน module จะเห็น menu ขึ้นมาเอง 
		เพราว่า เค้าตั้งให้ menu ขึ้นอัตโนมัติถ้ามีสิทธิ-->            
		
		<menuitem
			action="stock.action_picking_type_form"
            id="stock.menu_action_picking_type_form"
            parent="stock.menu_stock_warehouse_mgmt" sequence="1"
            groups="base.group_erp_manager"/> <!-- สั่งซ่อน menu All Operation ที่รวมทุกอย่าง ให้เห็นเฉพาะ Admin -->
        
        <menuitem id="stock.menu_traceability" name="Traceability" parent="stock.menu_stock_root" 
            sequence="3" groups="stock.group_stock_manager,stock.group_stock_user"/>
 		<menuitem id="stock.menu_stock_product" name="Products" parent="stock.menu_stock_root" 
 			sequence="6" groups="stock.group_stock_manager,stock.group_stock_user"/>

 <!-- ปรับ menu incoming product ให้จัดซื้อได้รับของเอง เฉพาะที่ของไม่เข้าโกดัง -->
 <!-- 
         <record id="action_receipt_picking_move_office" model="ir.actions.act_window">
            <field name="name">Incoming Products Office(รับของเข้า)</field>
            <field name="res_model">stock.move</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain" eval="[('picking_id.picking_type_id.code','=','incoming'), ('location_id.usage','!=','internal'), ('location_dest_id.usage', '=', 'internal'),('warehouse_id', '!=',1)]"/> 
            <field name="view_id" ref="stock.view_move_tree_receipt_picking"/>
            <field name="context">{'product_receive': True, 'search_default_future': True}</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to register a product receipt. 
              </p><p>
                Here you can receive individual products, no matter what
                purchase order or picking order they come from. You will find
                the list of all products you are waiting for. Once you receive
                an order, you can filter based on the name of the supplier or
                the purchase order reference. Then you can confirm all products
                received using the buttons on the right of each line.
              </p>
            </field>
        </record>
       <menuitem action="action_receipt_picking_move_office" id="purchase.menu_action_picking_tree_in_move"
            parent="purchase.menu_procurement_management_inventory" sequence="11"/>
  -->

  
    </data>
    
</openerp>

